---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
  const reviews = await getCollection('reviews');
  return reviews.map((review) => ({
    params: { slug: review.slug },
    props: { review },
  }));
}

const { review } = Astro.props;
const { Content } = await review.render();
---

<Layout title={review.data.title}>
  <div class="relative z-10 px-8 lg:px-18">
    <div class="mb-8">
      <a
        href="/reviews"
        class="animated-bottom-border text-light-text-heading font-bold after:mt-1 dark:text-white"
      >
        ← Zurück zu Reviews
      </a>
    </div>

    <article>
      <header class="mb-8">
        <h1
          class="text-light-text-heading mb-4 text-2xl font-bold lg:text-5xl dark:text-white"
        >
          {review.data.title}
        </h1>

        <div class="flex flex-wrap items-center gap-4 text-sm">
          <span class="rounded-full bg-gray-200 px-3 py-1 dark:bg-gray-700">
            {review.data.category}
          </span>
          <span class="text-yellow-500">
            {"★".repeat(Math.floor(review.data.rating))}
            {review.data.rating % 1 !== 0 && "☆"}
            {" "}
            {review.data.rating}/5
          </span>
          <time class="text-gray-500 dark:text-gray-400">
            {review.data.date.toLocaleDateString('de-AT', {
              year: 'numeric',
              month: 'long',
              day: 'numeric',
            })}
          </time>
        </div>
      </header>

      <div class="prose prose-lg dark:prose-invert max-w-none">
        <Content />
      </div>
    </article>
  </div>
</Layout>
